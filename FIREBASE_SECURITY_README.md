# إعدادات الأمان في Firebase

## وظائف السحاب (Cloud Functions)
- تم إزالة الاستيرادات غير المستخدمة لضمان نظافة الكود.
- تتحقق كل دالة مستدعاه (`onCall`) من وجود `context.auth` قبل التنفيذ لضمان أن المستخدم مصدّق.

## قواعد قاعدة البيانات Firestore
- **orders**: يسمح بإنشاء الطلبات للمستخدمين المصدّقين فقط، ويمكن لمالك الطلب أو المديرين قراءتها وتعديلها، بينما الحذف مقتصر على المسؤولين.
- **payments**: لا يمكن إنشاء دفعة إلا من قبل مالكها، ويستطيع المديرون قراءة الدفعات وتحديثها وحذفها.
- **users**: يمكن للمستخدم إنشاء وقراءة وتحديث بياناته الخاصة، بينما يملك المدير صلاحية الحذف.

## الاختبارات
لتشغيل اختبارات قواعد الأمان:
```bash
firebase emulators:exec --only firestore "node tests/firestore.rules.test.js"
```
